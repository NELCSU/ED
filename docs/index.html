<!DOCTYPE xhtml>
<html xmlns="https://www.w3.org/1999/xhtml">

<head>
	<meta http-equiv="content-Type" content="text/html; charset=utf-8" />
	<meta name="description" content="Urgent Care COVID-19 Flows" />
	<meta name="keywords" content="NHS, COVID-19, urgent care" />
	<title>Urgent Care COVID-19 Flows</title>

	<link href="favicon.png" rel="shortcut icon" />
	<link href="css/index.css" rel="stylesheet" />
	<link href="css/nv.d3.css" rel="stylesheet" />

	<script src="js/dragdealer.js"></script>
	<script src="js/d3.v3.min.js"></script>
	<script src="js/nv.d3.min.js"></script>
	<script src="js/jszip.min.js"></script>
	<script src="js/JSZipUtils.min.js"></script>
</head>

<body>

	<!--TITLELBAR-->

	<div id="titlebar" class="acc">
		<img id="favicon" onclick="disp_content('#content',myhash);" src="favicon2.png" alt="Home" title="Home" />
		<span id="titletext" class="pagetitle" title="Food Energy Flows">Urgent Care COVID-19 Flows</span>
	</div>

	<!--LOADING-->
	<div id="loading" class="pagetitle" style="font-size:75px;z-index:0;position:absolute;top:120px;left:100px;">
		Loading...
	</div>

	<!--PAGE WRAPPER-->
	<div id="content" style="opacity:0;visibility:hidden;">

		<div id="titlebar-right">
			<span class="pagetitle" id="cid"></span>
			<span class="pagetitle" style="margin-left:5px; margin-right:5px;">|</span>
			<span class="pagetitle" id="yid"></span>
		</div>

		<!--SANKEY DIAGRAM CONTROLS-->
		<div id="sourcecontrol" class="acc" style="float:right; margin-right:10px; width:20%; margin-top:10px; min-width:220px; border-left:solid; height:98%; padding-left:20px;line-height:26px;z-index:600000;">
			<div style="display:block;overflow: hidden;white-space: nowrap;">
				<span style="float:left;">STP:</span>
				<span	style="float:right;">
					<select id="json_sources" name="json_sources" style="width:130px;direction: rtl;"></select>
				</span>
			</div>
			<div style="display:block;overflow: hidden;white-space: nowrap;">
				<span style="float:left;">Day:</span>
				<span	style="float:right;">
					<select id="days" name="days" style="width:130px;direction: rtl;"></select>
				</span>
			</div>
			<div style="display:block;overflow: hidden;white-space: nowrap;">
				<span style="float:left;">Calls:</span><span style="float:right;">
					<input type="radio" title="1: Food hypergroups" onclick="change();" name="r1" id="b00" value="1" />
					<input type="radio" title="2: Food supergroups" onclick="change();" name="r1" id="b10" value="2" />
					<input type="radio" title="3: FAO food groups" onclick="change();" name="r1" id="b20" value="3" />
					<input type="radio" title="4: FAO crop groups" onclick="change();" name="r1" id="b30" value="4" />
				</span>
			</div>
			<!--
			<div style="display:block;overflow: hidden;white-space: nowrap;">
				<span style="float:left;">Food system:</span><span style="float:right;">
					<input type="radio" title="1: Food hypergroups" onclick="change();" name="r1" id="b01" value="1" />
					<input type="radio" title="2: Food supergroups" onclick="change();" name="r1" id="b11" value="2" />
					<input type="radio" title="3: FAO food groups" onclick="change();" name="r1" id="b21" value="3" />
					<input type="radio" title="4: FAO crop groups" onclick="change();" name="r1" id="b31" value="4" />
				</span>
			</div> -->
			<!--
			<div style="display:block;overflow: hidden;white-space: nowrap;">
				<span	style="float:left;">Agri-system:</span><span style="float:right;">
					<input type="radio" title="1: Food hypergroups" onclick="change();" name="r1" id="b02" value="1" />
					<input type="radio" title="2: Food supergroups" onclick="change();" name="r1" id="b12" value="2" />
					<input type="radio" title="3: FAO food groups" onclick="change();" name="r1" id="b22" value="3" />
					<input type="radio" title="4: FAO crop groups" onclick="change();" name="r1" id="b32" value="4" />
				</span>
			</div> -->
			<!--
			<div style="display:block;overflow: hidden;white-space: nowrap;"><span style="float:left;">Food
					weight:</span><span style="float:right;">
					<input type="radio" title="1: Food hypergroups" onclick="change();" name="r1" id="b03" value="1" />
					<input type="radio" title="2: Food supergroups" onclick="change();" name="r1" id="b13" value="2" />
					<input type="radio" title="3: FAO food groups" onclick="change();" name="r1" id="b23" value="3" />
					<input type="radio" title="4: FAO crop groups" onclick="change();" name="r1" id="b33" value="4" />
				</span>
			</div> -->

			<div style="display:block;overflow: hidden;white-space: nowrap;"><span style="float:left;">Move nodes:</span>
				<div style="float:right; padding-right:0; margin-right:0;">
					<div style="font-size:20px;font-weight:bold;line-height:10px;">
						<input title="Enable horizontal node dragging" type="checkbox" id="xmove">
						<label for="xmove">↔</label>
						<img alt="" style="width:5px;height:0px;">
						<input title="Enable vertical node dragging" type="checkbox" id="ymove" checked>
						<label for="ymove">↕</label>
					</div>
				</div>
			</div>

			<div style="display:block;overflow: hidden;white-space: nowrap;"><span style="float:left;">Density:</span>
				<div style="float:right;">
					<div id="pslider" title="Drag slider to set diagram node padding" class="dragdealer"
						style="margin-top:2px;margin-left:-130px;width:130px; height:18px; position:absolute;">
						<div class="handle orange-bar">↔
							<script>
								var densityslider = new Dragdealer("pslider", {
									x: 0.5,
									steps: 5,
									snap: true,
									callback: function (a, b) {
										padding = paddingmultiplier * (1 - a) + 3;
										change()
									}
								});
							</script>
						</div>
					</div>
				</div>
			</div>

			<div style="display:block;overflow: hidden;white-space: nowrap;"><span style="float:left;">Opacity:</span>
				<div style="float:right;">
					<div id="oslider" title="Drag slider to set diagram flow opacities" class="dragdealer"
						style="margin-top:2px;margin-left:-130px;width:130px; height:18px; position:absolute;">
						<div class="handle orange-bar">↔
							<script>
								new Dragdealer("oslider", {
									x: 0.25,
									steps: 5,
									snap: true,
									callback: function (a, b) {
										lowopacity = 0.1 + 0.8 * a;
										change()
									}
								});
							</script>
						</div>
					</div>
				</div>
			</div>

			<div class="acc" style="display:block;overflow: hidden;white-space: nowrap; border-bottom:solid; padding-bottom:10px;">
				<span style="float:left;">
					Breakdown: <input type="checkbox" title="Toggle piechart" id="legend" onclick='updpievis()' checked />
				</span>
				<span style="float:right;">
					Legend: <input type="checkbox" title="Toggle piechart legend" id="legend2" onclick='updpieleg()' checked />
				</span>
			</div>
			<div id="units" style="position:absolute;right:10px;bottom:30px;">TWh</div>
		</div>

		<!--PIE CHARTS-->
		<div id="mypie" class="pielegend">
			<svg style="width:100%;height:100%;"></svg>
		</div>

		<div id="mypie2" class="pielegend">
			<svg style="width:100%;height:100%;"></svg>
		</div>

		<!--SANKEY DIAGRAM-->
		<div id="chart" onmousewheel="scrollsankey(event.wheelDelta)" style="z-index:5;">

			<!--DATA QUALITY INFO-->
			<div id="qualitywrap" style="position:absolute;left:40px;top:45px;text-align:center;" alt="" title="">
				<table style="text-align:left; font-size:15px; margin:0px; padding:0px;" cellpadding="0" cellspacing="0"
					class="pagetitle">
					<tr>
						<td>Data Availability</td>
					</tr>
					<tr>
						<td id="quality" style="font-size:33px;line-height:12px;"></td>
					</tr>
				</table>
			</div>

		</div>

		<!--TIME SLIDER-->
		<div id="timeslider" title="Drag slider to set display day. Identical to mouse scroll."
			class="dragdealer" style="position:fixed; bottom:20; left:40;">
			<div class="handle red-bar">
				<span class="value"></span>
			</div>
		</div>

		<!-- -------SCRIPTS--------- -->
		<script src="js/sankey.js"></script>
		<script src="js/food.js"></script>
	</div>

	<!--THEME TOOLBAR-->
	<div id="theme_toolbar">
		<select id="theme_choice">
			<option value="0" selected>Light</option>
			<option value="1">Dark</option>
		</select>
		<span style="font-weight:normal">theme enabled</span>
	</div>

	<!--THEME SELECTOR-->
	<script>
		var themeid = 0;
		var themes = ["#light", "#dark"];
		var themebg = ["#fff", "#111"];
		var themebgacc = ["#eee", "#222"];
		var themefont = ["#000", "#aa8"];
		var themetitlefont = ["#f60", "#aa8"];
		var themesankeyfont = ["#000", "#aa8"];
		var themesankeyfontw = ["normal", "bold"];
		var themepiefont = ["#000", "#111"];
		var themecolor = ["#f60", "#aa8"];
		var themeacc = ["#f80", "#aa6"];
		var themetooltipbg = ["rgba(255,255,255,0.9)", "rgba(0,0,0,0.9)"];
		var themetooltipborder = ["rgba(0,0,0,0.2)", "rgba(255,255,255,0.2)"];
		var themehelpbg = ["rgba(255,255,255,0.8)", "rgba(0,0,0,0.9)"];
		var themefavicon = ["favicon", "favicon2"];

		//set theme cell colors
		themes.forEach(function (k, i) {
			d3.select(k)
				.style("background", themebg[i])
				.style("color", themefont[i])
		})

		var piecolor = function (k) {
			d3.selectAll(".nv-label text")
				.style("fill", themepiefont[k])
			d3.selectAll(".nv-pie path")
				.style("stroke", themebgacc[k])
		}

		var theme = function (k) {
			themeid = k;

			//sankey update
			piecolor(k);
			d3.select("body")
				.style("background", themebg[k])
				.style("color", themefont[k])
				.style("fill", themefont[k]);

			d3.select("#imap").style("background", themebg[k]);
			d3.selectAll(".pagetitle").style("color", themetitlefont[k]);
			d3.selectAll(".acc").style("border-color", themebgacc[k]);
			d3.selectAll("#plotcontrol").style("border-color", themebgacc[k]);
			d3.selectAll("#description").style("border-color", themebgacc[k]);
			d3.selectAll(".dragdealer").style("background", themebgacc[k]);
			d3.selectAll("#json_sources, #days, #json_sources2, #json_sources3")
				.style("background", themebgacc[k])
				.style("color", themefont[k])
				.style("border-color", themetooltipborder[k]);
			d3.selectAll(".handle")
				.style("color", themebg[k])
				.style("background", themecolor[k])
			d3.selectAll(".tooltip")
				.style("background", themetooltipbg[k])
				.style("border-color", themetooltipborder[k]);
			d3.selectAll(".help")
				.style("background", themehelpbg[k])
				.style("border-color", themetooltipborder[k]);
			svg.style("font-weight", themesankeyfontw[k])
				.style("text-shadow", "0 1px 0 " + themebg[k]);

			d3.select("#ER").style("text-shadow", "0 2px 0 " + themebg[k]);
			d3.select("#EROEI").style("text-shadow", "0 2px 0 " + themebg[k]);
			d3.select("#favicon").attr("src", themefavicon[k] + ".png");
		}

		d3.select("#theme_choice").on("input", function () {
			theme(parseInt(d3.select(this).property('value')))
		});

		theme(themeid);
	</script>

	<script src="js/checksize.js"></script>
	
</body>
</html>